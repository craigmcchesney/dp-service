We are going to implement a method, DataImportUtility.importXlsxData() for importing PV time-series data from an Excel spreadsheet for use in both the Ingestion and Annotation APIs. This method is part of the client API and utilized initially by the desktop GUI application for both data ingestion and creating annotations that contain user-defined calculations.

Input to the method is a String containing the path to an xlsx file.  The method returns a DataImportResult object, which contains a ResultStatus object indicating success or failure of the operation, and in the case of failure an error message. When successful the DataImportResult includes 1) a list of protobuf Timestamp objects for the timestamps read from the xlsx file and 2) a list of protobuf DataColumn objects, one for each data column in the file (both are set to null in the result when the method fails).

The working directory for finding the proto files containing the API definitions for protobuf objects is ~/dp.fork/dp-java/dp-grpc.

A skeleton definition of the method is in the com.ospreydcs.dp.client.utility.DataImportUtility class.  Our goal is to fully implement that method according to the specifications below.

The method implementation should use the apache poi library for reading the excel spreadsheet, since that library is already in use within the project for exporting to excel format.

Regarding the file format, It is assumed that the first row of the xlsx file contains the column names.  The first two columns specify the timestamp for the row of data values using long-valued integers, one for epoch seconds and one for nanoseconds.  The remaining columns are assumed to contain PV time-series data values.  Every column must have a column name in the header row.  It is assumed that the data column cells contain either string or numeric data, as determined by the apache poi Cell object's getCellType().  There should be no empty rows or empty cells in the spreadsheet.

The method should read the first line of the file and treat it as a header row containing column names.  The method will ignore the column names for the first two timestamp columns.  The method will create a list of protobuf Timestamp objects that will contain the Timestamp created for each row read from the file.  For each of the remaining data columns, the utility will create a protobuf DataColumn, using the column name read from the xlsx file as the DataColumn name.

It should then read the remaining rows of the file, which are treated as data rows.  Each row should contain the same number of columns as the header row.  For each data row, the utility will append a Timestamp for the row to the list of Timestamps utilizing the values from the first two columns to set the Timestamp epochseconds and nanoseconds, respectively.  It will add a DataValue to the appropriate DataColumn for each data column read from the file, using either DataValue.setDoubleValue() for numeric cells or DataValue.setStringValue() for string cells.

If any error conditions are encountered, e.g., errors opening or reading the file, unexpected file format, blank rows, empty cells, etc, the method should return a DataImportResult with the constructor isError parameter set to true and an appropriate errorMsg indicating the nature of the problem, and set the timestamps and dataColumns constructor parameters to null.  Otherwise the isError flag is set to false, errorMsg is an empty String, and the lists of Timestamps and DataColumns built by the method are returned in the corresponding constructor parameters.
